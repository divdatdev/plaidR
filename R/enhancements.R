# The Plaid API
#
# The Plaid REST API. Please see https://plaid.com/docs/api for more details.
#
# The version of the OpenAPI document: 2020-09-14_1.146.0
# Generated by: https://openapi-generator.tech

#' @docType class
#' @title Enhancements
#'
#' @description Enhancements Class
#'
#' @format An \code{R6Class} generator object
#'
#' @field merchant_name  character [optional]
#'
#' @field website  character [optional]
#'
#' @field logo_url  character [optional]
#'
#' @field check_number  character [optional]
#'
#' @field payment_channel  \link{PaymentChannel} 
#'
#' @field category_id  character 
#'
#' @field category  list( character ) 
#'
#' @field location  \link{Location} 
#'
#' @field personal_finance_category  \link{PersonalFinanceCategory} [optional]
#'
#' @importFrom R6 R6Class
#' @importFrom jsonlite fromJSON toJSON
#' @export
Enhancements <- R6::R6Class(
  'Enhancements',
  public = list(
    `merchant_name` = NULL,
    `website` = NULL,
    `logo_url` = NULL,
    `check_number` = NULL,
    `payment_channel` = NULL,
    `category_id` = NULL,
    `category` = NULL,
    `location` = NULL,
    `personal_finance_category` = NULL,
    initialize = function(
        `payment_channel`, `category_id`, `category`, `location`, `merchant_name`=NULL, `website`=NULL, `logo_url`=NULL, `check_number`=NULL, `personal_finance_category`=NULL, ...
    ) {
      local.optional.var <- list(...)
      if (!missing(`payment_channel`)) {
        stopifnot(R6::is.R6(`payment_channel`))
        self$`payment_channel` <- `payment_channel`
      }
      if (!missing(`category_id`)) {
        stopifnot(is.character(`category_id`), length(`category_id`) == 1)
        self$`category_id` <- `category_id`
      }
      if (!missing(`category`)) {
        stopifnot(is.vector(`category`), length(`category`) != 0)
        sapply(`category`, function(x) stopifnot(is.character(x)))
        self$`category` <- `category`
      }
      if (!missing(`location`)) {
        stopifnot(R6::is.R6(`location`))
        self$`location` <- `location`
      }
      if (!is.null(`merchant_name`)) {
        stopifnot(is.character(`merchant_name`), length(`merchant_name`) == 1)
        self$`merchant_name` <- `merchant_name`
      }
      if (!is.null(`website`)) {
        stopifnot(is.character(`website`), length(`website`) == 1)
        self$`website` <- `website`
      }
      if (!is.null(`logo_url`)) {
        stopifnot(is.character(`logo_url`), length(`logo_url`) == 1)
        self$`logo_url` <- `logo_url`
      }
      if (!is.null(`check_number`)) {
        stopifnot(is.character(`check_number`), length(`check_number`) == 1)
        self$`check_number` <- `check_number`
      }
      if (!is.null(`personal_finance_category`)) {
        stopifnot(R6::is.R6(`personal_finance_category`))
        self$`personal_finance_category` <- `personal_finance_category`
      }
    },
    toJSON = function() {
      EnhancementsObject <- list()
      if (!is.null(self$`merchant_name`)) {
        EnhancementsObject[['merchant_name']] <-
          self$`merchant_name`
      }
      if (!is.null(self$`website`)) {
        EnhancementsObject[['website']] <-
          self$`website`
      }
      if (!is.null(self$`logo_url`)) {
        EnhancementsObject[['logo_url']] <-
          self$`logo_url`
      }
      if (!is.null(self$`check_number`)) {
        EnhancementsObject[['check_number']] <-
          self$`check_number`
      }
      if (!is.null(self$`payment_channel`)) {
        EnhancementsObject[['payment_channel']] <-
          self$`payment_channel`$toJSON()
      }
      if (!is.null(self$`category_id`)) {
        EnhancementsObject[['category_id']] <-
          self$`category_id`
      }
      if (!is.null(self$`category`)) {
        EnhancementsObject[['category']] <-
          self$`category`
      }
      if (!is.null(self$`location`)) {
        EnhancementsObject[['location']] <-
          self$`location`$toJSON()
      }
      if (!is.null(self$`personal_finance_category`)) {
        EnhancementsObject[['personal_finance_category']] <-
          self$`personal_finance_category`$toJSON()
      }

      EnhancementsObject
    },
    fromJSON = function(EnhancementsJson) {
      EnhancementsObject <- jsonlite::fromJSON(EnhancementsJson)
      if (!is.null(EnhancementsObject$`merchant_name`)) {
        self$`merchant_name` <- EnhancementsObject$`merchant_name`
      }
      if (!is.null(EnhancementsObject$`website`)) {
        self$`website` <- EnhancementsObject$`website`
      }
      if (!is.null(EnhancementsObject$`logo_url`)) {
        self$`logo_url` <- EnhancementsObject$`logo_url`
      }
      if (!is.null(EnhancementsObject$`check_number`)) {
        self$`check_number` <- EnhancementsObject$`check_number`
      }
      if (!is.null(EnhancementsObject$`payment_channel`)) {
        payment_channelObject <- PaymentChannel$new()
        payment_channelObject$fromJSON(jsonlite::toJSON(EnhancementsObject$payment_channel, auto_unbox = TRUE, digits = NA))
        self$`payment_channel` <- payment_channelObject
      }
      if (!is.null(EnhancementsObject$`category_id`)) {
        self$`category_id` <- EnhancementsObject$`category_id`
      }
      if (!is.null(EnhancementsObject$`category`)) {
        self$`category` <- ApiClient$new()$deserializeObj(EnhancementsObject$`category`, "array[character]", loadNamespace("plaidr"))
      }
      if (!is.null(EnhancementsObject$`location`)) {
        locationObject <- Location$new()
        locationObject$fromJSON(jsonlite::toJSON(EnhancementsObject$location, auto_unbox = TRUE, digits = NA))
        self$`location` <- locationObject
      }
      if (!is.null(EnhancementsObject$`personal_finance_category`)) {
        personal_finance_categoryObject <- PersonalFinanceCategory$new()
        personal_finance_categoryObject$fromJSON(jsonlite::toJSON(EnhancementsObject$personal_finance_category, auto_unbox = TRUE, digits = NA))
        self$`personal_finance_category` <- personal_finance_categoryObject
      }
      self
    },
    toJSONString = function() {
      jsoncontent <- c(
        if (!is.null(self$`merchant_name`)) {
        sprintf(
        '"merchant_name":
          "%s"
                ',
        self$`merchant_name`
        )},
        if (!is.null(self$`website`)) {
        sprintf(
        '"website":
          "%s"
                ',
        self$`website`
        )},
        if (!is.null(self$`logo_url`)) {
        sprintf(
        '"logo_url":
          "%s"
                ',
        self$`logo_url`
        )},
        if (!is.null(self$`check_number`)) {
        sprintf(
        '"check_number":
          "%s"
                ',
        self$`check_number`
        )},
        if (!is.null(self$`payment_channel`)) {
        sprintf(
        '"payment_channel":
        %s
        ',
        jsonlite::toJSON(self$`payment_channel`$toJSON(), auto_unbox=TRUE, digits = NA)
        )},
        if (!is.null(self$`category_id`)) {
        sprintf(
        '"category_id":
          "%s"
                ',
        self$`category_id`
        )},
        if (!is.null(self$`category`)) {
        sprintf(
        '"category":
           [%s]
        ',
        paste(unlist(lapply(self$`category`, function(x) paste0('"', x, '"'))), collapse=",")
        )},
        if (!is.null(self$`location`)) {
        sprintf(
        '"location":
        %s
        ',
        jsonlite::toJSON(self$`location`$toJSON(), auto_unbox=TRUE, digits = NA)
        )},
        if (!is.null(self$`personal_finance_category`)) {
        sprintf(
        '"personal_finance_category":
        %s
        ',
        jsonlite::toJSON(self$`personal_finance_category`$toJSON(), auto_unbox=TRUE, digits = NA)
        )}
      )
      jsoncontent <- paste(jsoncontent, collapse = ",")
      paste('{', jsoncontent, '}', sep = "")
    },
    fromJSONString = function(EnhancementsJson) {
      EnhancementsObject <- jsonlite::fromJSON(EnhancementsJson)
      self$`merchant_name` <- EnhancementsObject$`merchant_name`
      self$`website` <- EnhancementsObject$`website`
      self$`logo_url` <- EnhancementsObject$`logo_url`
      self$`check_number` <- EnhancementsObject$`check_number`
      self$`payment_channel` <- PaymentChannel$new()$fromJSON(jsonlite::toJSON(EnhancementsObject$payment_channel, auto_unbox = TRUE, digits = NA))
      self$`category_id` <- EnhancementsObject$`category_id`
      self$`category` <- ApiClient$new()$deserializeObj(EnhancementsObject$`category`, "array[character]", loadNamespace("plaidr"))
      self$`location` <- Location$new()$fromJSON(jsonlite::toJSON(EnhancementsObject$location, auto_unbox = TRUE, digits = NA))
      self$`personal_finance_category` <- PersonalFinanceCategory$new()$fromJSON(jsonlite::toJSON(EnhancementsObject$personal_finance_category, auto_unbox = TRUE, digits = NA))
      self
    }
  )
)
